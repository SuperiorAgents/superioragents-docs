"use strict";(self.webpackChunksuperior_agents_docs=self.webpackChunksuperior_agents_docs||[]).push([[6509],{233:e=>{e.exports=JSON.parse('{"permalink":"/superioragents-docs/blog/2025-05-15-adapting-diffusion-models","editUrl":"https://github.com/superioragents/superior-agents/edit/main/blog/blog/2025-05-15-adapting-diffusion-models/2025-05-15-adapting-diffusion-models.md","source":"@site/blog/2025-05-15-adapting-diffusion-models/2025-05-15-adapting-diffusion-models.md","title":"Adapting Diffusion Models for No-Propagation Learning","description":"A comprehensive report on extending backprop-free \u201cNoProp\u201d diffusion training from image classification to text generation, covering state-of-the-art diffusion LMs, alternative learning rules, challenges, and research directions.","date":"2025-05-15T00:00:00.000Z","tags":[{"inline":false,"label":"Superior Agents","permalink":"/superioragents-docs/blog/tags/superioragents","description":"Superior Agents tag description"},{"inline":false,"label":"Research","permalink":"/superioragents-docs/blog/tags/research","description":"Research tag description"}],"readingTime":5.54,"hasTruncateMarker":true,"authors":[{"name":"Jen D.","title":"Chief AI Engineer @ KIP","page":{"permalink":"/superioragents-docs/blog/authors/jen"},"socials":{"x":"https://x.com/HumanLevelJen"},"imageURL":"https://pbs.twimg.com/profile_images/1917918976488747008/kWobzLPQ_400x400.jpg","key":"jen"}],"frontMatter":{"slug":"2025-05-15-adapting-diffusion-models","title":"Adapting Diffusion Models for No-Propagation Learning","authors":["jen"],"tags":["Superior Agents","research"]},"unlisted":false,"nextItem":{"title":"Less Data, More Intelligence: How Curated Training Data Unlocks LLM Power","permalink":"/superioragents-docs/blog/2025-05-15-less-data-more-intelligence"}}')},6909:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>d});var r=i(233),s=i(4848),o=i(8453);const t={slug:"2025-05-15-adapting-diffusion-models",title:"Adapting Diffusion Models for No-Propagation Learning",authors:["jen"],tags:["Superior Agents","research"]},a=void 0,l={authorsImageUrls:[void 0]},d=[{value:"Introduction",id:"introduction",level:2},{value:"Diffusion Models in Text Generation (Background)",id:"diffusion-models-in-text-generation-background",level:2},{value:"No-Propagation Learning Techniques (Background)",id:"no-propagation-learning-techniques-background",level:2},{value:"How NoProp Works in Image Classification",id:"how-noprop-works-in-image-classification",level:3},{value:"Adapting Diffusion No-Prop Techniques to Text Generation",id:"adapting-diffusion-no-prop-techniques-to-text-generation",level:2},{value:"1  Representation of Text for Diffusion",id:"1--representation-of-text-for-diffusion",level:3},{value:"2  Model Architecture for Text Denoising",id:"2--model-architecture-for-text-denoising",level:3},{value:"3  Feasibility Evidence",id:"3--feasibility-evidence",level:3},{value:"4  Key Challenges",id:"4--key-challenges",level:3},{value:"5  Comparisons to Backprop Training",id:"5--comparisons-to-backprop-training",level:3},{value:"Outlook and Ongoing Work",id:"outlook-and-ongoing-work",level:2}];function c(e){const n={a:"a",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"A comprehensive report on extending backprop-free \u201cNoProp\u201d diffusion training from image classification to text generation, covering state-of-the-art diffusion LMs, alternative learning rules, challenges, and research directions."})}),"\n",(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsxs)(n.p,{children:["Recent research has begun exploring backpropagation-free learning methods as an alternative to the traditional gradient-descent/backpropagation algorithm. The motivation includes reducing memory overhead (since back-prop requires storing activations) and enabling more parallel or biologically plausible training (",(0,s.jsx)(n.a,{href:"https://medium.com",children:"medium.com"}),"). One promising avenue is to leverage ideas from ",(0,s.jsx)(n.strong,{children:"diffusion models"}),"\u2014generative models that iteratively refine noisy data\u2014to train networks ",(0,s.jsx)(n.strong,{children:"without"})," standard error back-propagation."]}),"\n",(0,s.jsxs)(n.p,{children:["In image classification, a new method called ",(0,s.jsx)(n.strong,{children:"NoProp"})," showed that a neural network can be trained ",(0,s.jsx)(n.strong,{children:"without any forward or backward propagation"})," by having each layer learn to denoise a noisy target (here, a noisy label embedding) (",(0,s.jsx)(n.a,{href:"https://medium.com",children:"medium.com"}),", ",(0,s.jsx)(n.a,{href:"https://paperswithcode.com",children:"paperswithcode.com"}),")."]}),"\n",(0,s.jsxs)(n.p,{children:["This report investigates the feasibility of extending such no-prop, diffusion-inspired training from simple labeling tasks to ",(0,s.jsx)(n.strong,{children:"text generation"}),". We review progress (2023-2025) on diffusion models for language, summarize no-propagation learning techniques, and assess how diffusion architectures might be adapted to support training without traditional backprop. We also discuss existing implementations, theoretical support, and key challenges, comparing them to conventional paradigms."]}),"\n",(0,s.jsx)(n.h2,{id:"diffusion-models-in-text-generation-background",children:"Diffusion Models in Text Generation (Background)"}),"\n",(0,s.jsx)(n.p,{children:"Diffusion models have emerged as a powerful class of generative models\u2014first in image synthesis, and more recently in text."}),"\n",(0,s.jsxs)(n.p,{children:["In text generation they are typically used in a ",(0,s.jsx)(n.strong,{children:"non-autoregressive (NAR)"})," setting: the model generates an entire sequence through parallel or iterative refinement rather than token-by-token autoregression. A forward ",(0,s.jsx)(n.em,{children:"noising"})," process gradually corrupts a text representation; a neural model is trained to reverse this process, transforming noise back into coherent text. A 2023 survey showed that introducing diffusion models into NAR text generation significantly narrows the gap with traditional autoregressive transformers (",(0,s.jsx)(n.a,{href:"https://ar5iv.org",children:"ar5iv.org"}),")."]}),"\n",(0,s.jsx)(n.p,{children:"Two main paradigms exist:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Discrete diffusion"})," (operating directly on token sequences)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Continuous/embedding diffusion"})," (adding noise in a continuous space)"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Embedding diffusion has proven more effective and flexible (",(0,s.jsx)(n.a,{href:"https://aclanthology.org",children:"ACL Anthology"}),"). The workflow:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Define an embedding for each token/sequence."}),"\n",(0,s.jsx)(n.li,{children:"Add Gaussian noise over a series of timesteps."}),"\n",(0,s.jsx)(n.li,{children:"Train a model to gradually remove the noise."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Because the denoised output is continuous, an ",(0,s.jsx)(n.strong,{children:"encoder\u2013decoder bridge"})," is required: map discrete tokens \u2192 embeddings \u2192 ",(0,s.jsx)(n.strong,{children:"diffusion"})," \u2192 denoised embeddings \u2192 tokens (e.g. via arg-max over a vocabulary projection). Regularization (e.g. the ",(0,s.jsx)(n.em,{children:"anchor loss"})," in ",(0,s.jsx)(n.strong,{children:"Difformer"}),") prevents the embedding space from collapsing (",(0,s.jsx)(n.a,{href:"https://aclanthology.org",children:"ACL Anthology"}),")."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Key examples"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DiffuSeq"})," (ICLR 2023): sequence-to-sequence diffusion for translation & paraphrasing (",(0,s.jsx)(n.a,{href:"https://github.com/diffuseq",children:"GitHub"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Diffusion-LM"})," (NeurIPS 2022): controllable text generation via latent-space diffusion (",(0,s.jsx)(n.a,{href:"https://github.com/Diffusion-LM",children:"GitHub"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"FlowSeq / Flow matching"})," (EACL 2024): treats generation as an ODE that transports noisy text embeddings to clean embeddings in a few large steps (",(0,s.jsx)(n.a,{href:"https://aclanthology.org",children:"ACL Anthology"}),")."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["These advances have reduced required diffusion steps from hundreds to \u223c10-20, making diffusion LMs practical. ",(0,s.jsx)(n.strong,{children:"All"})," are still trained with standard backprop\u2014raising the question: ",(0,s.jsx)(n.em,{children:"Can we train such models without backprop"}),"?"]}),"\n",(0,s.jsx)(n.h2,{id:"no-propagation-learning-techniques-background",children:"No-Propagation Learning Techniques (Background)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"No-prop"})," (no-backprop) learning avoids global gradient propagation."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Forward-Forward (FF) algorithm"})," (",(0,s.jsx)(n.a,{href:"https://cs.toronto.edu",children:"cs.toronto.edu"}),"): two forward passes (positive vs. negative data) adjust weights via a local goodness measure."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Target propagation"})," (",(0,s.jsx)(n.a,{href:"https://paperswithcode.com",children:"paperswithcode.com"}),"): propagate ",(0,s.jsx)(n.em,{children:"targets"})," (desired activations) instead of gradients."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Feedback alignment"}),": random feedback weights replace exact gradient transposes."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Zeroth-order (ZO) optimization"})," (",(0,s.jsx)(n.a,{href:"https://arxiv.org",children:"arXiv"}),"): evolutionary strategies / finite-difference updates using only forward passes."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Greedy layer-wise training"}),": train one layer (or block) at a time (e.g. stacked autoencoders)."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Despite decades of effort, none matched the ease/performance of backprop on large tasks\u2014until ",(0,s.jsx)(n.strong,{children:"NoProp"})," (Li, Teh & Pascanu 2025), a ",(0,s.jsx)(n.strong,{children:"gradient-free method inspired by denoising diffusion"})," (",(0,s.jsx)(n.a,{href:"https://paperswithcode.com",children:"paperswithcode.com"}),")."]}),"\n",(0,s.jsx)(n.h3,{id:"how-noprop-works-in-image-classification",children:"How NoProp Works in Image Classification"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Label embedding space:"})," each class label = learnable vector (not one-hot)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Add Gaussian noise"})," at multiple levels\u2014one level per layer."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Layer $t$"})," receives the noisy label from layer $t!-!1$ plus the original image ",(0,s.jsx)(n.em,{children:"x"}),", and learns to predict the clean label embedding (MSE loss)."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Because each layer is trained ",(0,s.jsx)(n.strong,{children:"in isolation"})," (fixed noise level, local loss), ",(0,s.jsx)(n.strong,{children:"no forward/backward pass through the full network is needed"}),". Layers could even train in parallel."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Results:"})," NoProp matched backprop accuracy on MNIST/CIFAR-10 with \u2248 \xbd GPU memory and faster training (",(0,s.jsx)(n.a,{href:"https://medium.com",children:"medium.com"}),"). It outperformed previous no-backprop methods in both accuracy and simplicity\u2014providing a blueprint for gradient-free training."]}),"\n",(0,s.jsx)(n.h2,{id:"adapting-diffusion-no-prop-techniques-to-text-generation",children:"Adapting Diffusion No-Prop Techniques to Text Generation"}),"\n",(0,s.jsx)(n.p,{children:"Extending no-prop to text is promising yet challenging."}),"\n",(0,s.jsx)(n.h3,{id:"1--representation-of-text-for-diffusion",children:"1  Representation of Text for Diffusion"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Convert sentences to continuous embeddings (pretrained or learned)."}),"\n",(0,s.jsx)(n.li,{children:"Assign each layer a fixed noise level; train it to denoise toward clean embeddings (either one-step-to-clean or step-wise targets)."}),"\n",(0,s.jsx)(n.li,{children:"Decode final embeddings to tokens via a vocabulary projection. The decoder itself could be trained via a diffusion-style objective or separately with simple supervision."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2--model-architecture-for-text-denoising",children:"2  Model Architecture for Text Denoising"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Unrolled Transformer decoder:"})," stack ",(0,s.jsx)(n.strong,{children:"T"})," distinct blocks, each a diffusion step; give each block a timestep/noise embedding."]}),"\n",(0,s.jsx)(n.li,{children:"Train each block independently on (source context, noisy target) \u2192 clean target."}),"\n",(0,s.jsx)(n.li,{children:"Parameter explosion for large T: mitigate via smaller blocks, shared encoders (if conditional), or future weight-tying research."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3--feasibility-evidence",children:"3  Feasibility Evidence"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Denoising score matching"})," (theory behind diffusion) supports stacked local denoisers (",(0,s.jsx)(n.a,{href:"https://arxiv.org",children:"arXiv"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Flow matching"})," & diffusion-LM successes show unrolled, non-end-to-end training can work (",(0,s.jsx)(n.a,{href:"https://aclanthology.org",children:"ACL Anthology"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"ZO fine-tuning"})," proves large LLMs can update without gradients, hinting memory advantages for no-prop diffusion (",(0,s.jsx)(n.a,{href:"https://arxiv.org",children:"arXiv"}),")."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"4--key-challenges",children:"4  Key Challenges"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Discrete data complexity"})," \u2192 need robust embedding space (anchor losses, pretrained init)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Sequential coherence"})," \u2192 may require self-conditioning or iterative strategies."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Scaling & depth"})," \u2192 many denoising steps increase parameters; continuous-time variants might share weights."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Noise scheduling & coordination"})," \u2192 schedule design, layer-interaction, iterative refinement without backprop."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Evaluation"})," \u2192 global quality metrics for a stack of independently trained layers."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"5--comparisons-to-backprop-training",children:"5  Comparisons to Backprop Training"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Credit assignment:"})," local (no-prop) vs. global (backprop) may yield different representation hierarchies."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Optimization:"})," many independent sub-problems vs. one joint problem; hybrids (independent pre-train + light joint fine-tune) are conceivable."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Inference speed:"})," fixed-T diffusion vs. token-by-token autoregression; pipeline parallelism possible."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Reuse of pretrained knowledge:"})," initializing layers from pretrained transformers or embeddings can bootstrap no-prop models."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"outlook-and-ongoing-work",children:"Outlook and Ongoing Work"}),"\n",(0,s.jsx)(n.p,{children:"As of early 2025, no published no-prop text generator exists, but building blocks are ready:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Small-scale proofs-of-concept (limited-vocabulary autoencoders) are likely next."}),"\n",(0,s.jsxs)(n.li,{children:["Improved local-loss algorithms (e.g. \u201cTrifecta\u201d stabilizers for forward-forward) will aid no-prop diffusion (",(0,s.jsx)(n.a,{href:"https://medium.com",children:"medium.com"}),")."]}),"\n",(0,s.jsx)(n.li,{children:"Embedding-space safeguards (anchor loss) and step-distillation can transfer directly."}),"\n",(0,s.jsxs)(n.li,{children:["Biological inspiration: no-prop diffusion resembles cortical iterative denoising loops (",(0,s.jsx)(n.a,{href:"https://cs.toronto.edu",children:"cs.toronto.edu"}),")."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"If engineering hurdles are cleared\u2014scaling, coherence, efficiency\u2014we could see new language models trained in a highly distributed, memory-light fashion, offering novel generalization properties. The next 1-2 years will be pivotal for backprop-free generative modeling, with text generation as a key benchmark."}),"\n",(0,s.jsx)(n.hr,{})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>a});var r=i(6540);const s={},o=r.createContext(s);function t(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);